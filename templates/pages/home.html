{% extends "base.html" %}
{% block title %}Hakam Tours — Explore Kenya{% endblock %}
{% block content %}

  <!-- Hero Section -->
  <section class="relative bg-cover bg-center h-[500px] flex items-center justify-center rounded-xl"
           style="background-image: url('/static/images/coast1.jpg');">
    <!-- Dark overlay -->
    <div class="absolute inset-0 bg-black bg-opacity-40 rounded-xl"></div>
    
    <!-- Hero Content -->
    <div class="relative text-center p-6 max-w-3xl">
      <h1 class="text-4xl md:text-5xl font-extrabold text-white mb-4">
        Discover Your Next Adventure with Tembea
      </h1>
      <p class="text-white text-lg mb-6">
        Explore curated travel experiences designed to inspire and connect you with the world’s most breathtaking destinations. 
        From serene beaches to vibrant cityscapes, Tembea offers personalized journeys that cater to your unique travel desires.
      </p>
      <a href="{% url 'trips:trip_list' %}" 
         class="bg-blue-600 text-white px-6 py-3 rounded-lg font-semibold shadow hover:bg-blue-700 transition">
         Explore Destinations
      </a>
    </div>
  </section>

  <!-- Featured Trips Section -->
  <section class="py-16 bg-gray-50">
    <div class="max-w-6xl mx-auto px-6">
      <h2 class="text-2xl font-bold mb-10 text-center">Featured Trips</h2>
      
      <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-8">
        {% for trip in current_trips %}
          <a href="{% url 'trips:trip_detail' trip.slug %}" 
             class="group relative block bg-white rounded-xl shadow hover:shadow-lg overflow-hidden transition">
            
            <!-- Wishlist Button -->
            {% if user.is_authenticated %}
              <form method="post" 
                    action="{% url 'trips:toggle_wishlist' trip.id %}" 
                    class="absolute top-3 right-3 z-10">
                {% csrf_token %}
                <button type="submit" class="focus:outline-none">
                  {% if trip.id in wishlist_ids %}
                    <span class="text-red-500 text-2xl">♥</span>
                  {% else %}
                    <span class="text-gray-300 hover:text-red-500 text-2xl">♡</span>
                  {% endif %}
                </button>
              </form>
            {% else %}
              <a href="{% url 'login' %}" 
                 class="absolute top-3 right-3 z-10 text-gray-300 hover:text-red-500 text-2xl">♡</a>
            {% endif %}

            <!-- Trip image -->
            {% if trip.cover_image %}
              <img src="{{ trip.cover_image.url }}" alt="{{ trip.title }}"
                   class="h-48 w-full object-cover group-hover:scale-105 transition-transform duration-300">
            {% else %}
              <div class="h-48 bg-gray-200 flex items-center justify-center text-gray-500">
                No Image
              </div>
            {% endif %}

            <!-- Trip details -->
            <div class="p-4">
              <h3 class="text-md font-semibold text-gray-900 group-hover:text-blue-600">
                {{ trip.title }}
              </h3>

              <!-- Duration -->
              <div class="mt-2 flex items-center text-sm text-gray-500">
                <span class="mr-2">⏱</span>
                {{ trip.start_date }} – {{ trip.end_date }}
              </div>

              <!-- Reviews -->
              {% if trip.average_rating %}
                <div class="mt-2 flex items-center text-yellow-500 text-sm">
                  {% for i in "12345" %}
                    {% if forloop.counter <= trip.average_rating|floatformat:0 %}
                      ⭐
                    {% else %}
                      <span class="text-gray-300">⭐</span>
                    {% endif %}
                  {% endfor %}
                  <span class="ml-2 text-gray-600">{{ trip.average_rating|floatformat:2 }}/5</span>
                </div>
              {% else %}
                <p class="mt-2 text-sm text-gray-400">No reviews yet</p>
              {% endif %}

              <!-- Price -->
              {% if trip.get_min_price %}
                <div class="mt-4 flex justify-between items-center border-t pt-3">
                  <span class="text-sm text-gray-600">From 
                    <span class="text-red-600 font-bold">Ksh {{ trip.get_min_price|floatformat:0 }}</span>
                  </span>
                  <span class="text-blue-600 text-sm font-semibold flex items-center">
                    More Information →
                  </span>
                </div>
              {% else %}
                <p class="mt-3 text-sm text-gray-500">No packages available</p>
              {% endif %}
            </div>
          </a>
        {% empty %}
          <article class="text-center text-gray-500 col-span-full">No trips available</article>
        {% endfor %}
      </div>
    </div>
  </section>

  <!-- Past Trips Section -->
  <section class="py-16">
    <div class="max-w-6xl mx-auto px-6">
      <h2 class="text-2xl font-bold mb-10 text-center">Past Trips</h2>

      <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-8">
        {% for trip in past_trips %}
          <a href="{% url 'trips:trip_detail' trip.slug %}" 
             class="group relative block bg-white rounded-xl shadow hover:shadow-lg overflow-hidden transition">
  
            <!-- Wishlist Button -->
            {% if user.is_authenticated %}
              <form method="post" 
                    action="{% url 'trips:toggle_wishlist' trip.id %}" 
                    class="absolute top-3 right-3 z-10">
                {% csrf_token %}
                <button type="submit" class="focus:outline-none">
                  {% if trip.id in wishlist_ids %}
                    <span class="text-red-500 text-2xl">♥</span>
                  {% else %}
                    <span class="text-gray-300 hover:text-red-500 text-2xl">♡</span>
                  {% endif %}
                </button>
              </form>
            {% else %}
              <a href="{% url 'login' %}" 
                 class="absolute top-3 right-3 z-10 text-gray-300 hover:text-red-500 text-2xl">♡</a>
            {% endif %}

            <!-- Trip image -->
            {% if trip.cover_image %}
              <img src="{{ trip.cover_image.url }}" alt="{{ trip.title }}"
                   class="h-48 w-full object-cover group-hover:scale-105 transition-transform duration-300">
            {% else %}
              <div class="h-48 bg-gray-200 flex items-center justify-center text-gray-500">
                No Image
              </div>
            {% endif %}

            <!-- Trip details -->
            <div class="p-4">
              <h3 class="text-md font-semibold text-gray-900 group-hover:text-blue-600">
                {{ trip.title }}
              </h3>

              <!-- Duration -->
              <div class="mt-2 flex items-center text-sm text-gray-500">
                <span class="mr-2">⏱</span>
                {{ trip.start_date }} – {{ trip.end_date }}
              </div>

              <!-- Reviews -->
              {% if trip.average_rating %}
                <div class="mt-2 flex items-center text-yellow-500 text-sm">
                  {% for i in "12345" %}
                    {% if forloop.counter <= trip.average_rating|floatformat:0 %}
                      ⭐
                    {% else %}
                      <span class="text-gray-300">⭐</span>
                    {% endif %}
                  {% endfor %}
                  <span class="ml-2 text-gray-600">{{ trip.average_rating|floatformat:2 }}/5</span>
                </div>
              {% else %}
                <p class="mt-2 text-sm text-gray-400">No reviews yet</p>
              {% endif %}

              <!-- Price -->
              {% if trip.get_min_price %}
                <div class="mt-4 flex justify-between items-center border-t pt-3">
                  <span class="text-sm text-gray-600">From 
                    <span class="text-red-600 font-bold">Ksh {{ trip.get_min_price|floatformat:0 }}</span>
                  </span>
                  <span class="text-blue-600 text-sm font-semibold flex items-center">
                    More Information →
                  </span>
                </div>
              {% else %}
                <p class="mt-3 text-sm text-gray-500">No packages available</p>
              {% endif %}
            </div>
          </a>
        {% empty %}
          <article class="text-center text-gray-500 col-span-full">No past trips recorded</article>
        {% endfor %}
      </div>
    </div>
  </section>

{% endblock %}
